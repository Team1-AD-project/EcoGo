# å®Œæ•´æ³¨å†Œæµç¨‹å®ç°æ–¹æ¡ˆ ğŸ“‹

## æ¦‚è¿°

å®ç°äº†**6æ­¥å®Œæ•´æ³¨å†Œæµç¨‹** + **é¦–æ¬¡ä½¿ç”¨åŠŸèƒ½å¼•å¯¼**ï¼Œå…¨é¢æ”¶é›†ç”¨æˆ·ä¿¡æ¯ç”¨äºä¸ªæ€§åŒ–æ¨èã€‚

---

## ğŸ¯ å®Œæ•´æ³¨å†Œæµç¨‹ï¼ˆ6æ­¥ï¼‰

### Step 0: ä¸ªäººä¿¡æ¯å¡«å†™ âœ…
**æ–‡ä»¶**: `fragment_signup_wizard.xml` (layout_personal_info)
- ç”¨æˆ·åï¼ˆè‡³å°‘3å­—ç¬¦ï¼‰
- é‚®ç®±åœ°å€ï¼ˆæ ¼å¼éªŒè¯ï¼‰
- NUSNET IDï¼ˆeå¼€å¤´ï¼‰

### Step 1: å­¦é™¢é€‰æ‹© âœ…
**æ–‡ä»¶**: `fragment_signup_wizard.xml` (layout_faculty_selection)
- ViewPager2æ»‘åŠ¨å¡ç‰‡
- ç‚¹å‡»é€‰æ‹©å³è·³è½¬

### Step 2: äº¤é€šåå¥½ ğŸ†•
**æ–‡ä»¶**: `layout_transport_preference.xml`
- ğŸšŒ Busï¼ˆæ ¡å›­å·´å£«&å…¬äº¤ï¼‰
- ğŸš¶ Walkingï¼ˆæ­¥è¡Œï¼‰
- ğŸš² Cyclingï¼ˆéª‘è¡Œ/ç”µåŠ¨è½¦ï¼‰
- ğŸš— Carpoolï¼ˆæ‹¼è½¦ï¼‰
- å¤šé€‰å¡ç‰‡ç•Œé¢

### Step 3: å¸¸ç”¨åœ°ç‚¹ ğŸ†•
**æ–‡ä»¶**: `layout_common_locations.xml`
- ğŸ  Dormitoryï¼ˆå®¿èˆï¼‰
- ğŸ« Teaching Buildingï¼ˆæ•™å­¦æ¥¼ï¼‰
- ğŸ“š Study Spotï¼ˆå­¦ä¹ åœ°ç‚¹ï¼‰
- å¿«æ·é€‰æ‹©ï¼šGymã€Canteenã€Labã€Sports Complex
- å¯è·³è¿‡

### Step 4: å…´è¶£ä¸ç›®æ ‡ ğŸ†•
**æ–‡ä»¶**: `layout_interests_goals.xml`
- ğŸŒ± å…´è¶£åå¥½ï¼ˆSustainabilityã€Challengesã€Communityã€Rewardsã€Leaderboardï¼‰
- ğŸ¯ æ¯å‘¨ç›®æ ‡ï¼ˆ1-20æ¬¡ç»¿è‰²å‡ºè¡Œï¼‰
- ğŸ”” é€šçŸ¥åå¥½ï¼ˆæŒ‘æˆ˜ã€æ´»åŠ¨æé†’ã€å¥½å‹åŠ¨æ€ï¼‰

### Step 5: å°ç‹®å­å±•ç¤º âœ…
**æ–‡ä»¶**: `fragment_signup_wizard.xml` (layout_mascot_reveal)
- æ¬¢è¿ç”¨æˆ·
- å±•ç¤ºå°ç‹®å­å’Œå­¦é™¢è£…å¤‡

---

## ğŸš€ é¦–æ¬¡ä½¿ç”¨åŠŸèƒ½å¼•å¯¼

### è§¦å‘æ—¶æœº
- âœ… åªåœ¨é¦–æ¬¡æ³¨å†ŒæˆåŠŸåæ˜¾ç¤º
- âœ… å¯ä»¥è·³è¿‡
- âœ… åç»­ç™»å½•ä¸å†æ˜¾ç¤º

### å¼•å¯¼å†…å®¹ï¼ˆå»ºè®®4-5é¡µï¼‰

#### é¡µé¢1: æ¬¢è¿é¡µ
```
ğŸ‰ Welcome to EcoGo!

Transform your daily commute into
an environmental impact

[å›¾ï¼šå°ç‹®å­æ¬¢è¿æ‰‹åŠ¿]
```

#### é¡µé¢2: ç»¿è‰²å‡ºè¡Œ
```
ğŸšŒ Track Your Green Trips

Earn points for every eco-friendly
journey you take

[å›¾ï¼šå·´å£«è·¯çº¿è§„åˆ’ç•Œé¢]
```

#### é¡µé¢3: æŒ‘æˆ˜ç³»ç»Ÿ
```
ğŸ† Join Challenges

Compete with friends and your
faculty for rewards

[å›¾ï¼šæŒ‘æˆ˜åˆ—è¡¨]
```

#### é¡µé¢4: å°ç‹®å­æ¢è£…
```
ğŸ¨ Customize Your Mascot

Unlock outfits and accessories
as you progress

[å›¾ï¼šå°ç‹®å­æ¢è£…ç•Œé¢]
```

#### é¡µé¢5: å¼€å§‹ä½¿ç”¨
```
ğŸŒ± Ready to make a difference?

Start your first green trip today!

[æŒ‰é’®ï¼šLet's Go!]
```

---

## ğŸ“Š æ”¶é›†çš„ç”¨æˆ·æ•°æ®

### åŸºç¡€ä¿¡æ¯
```kotlin
data class UserProfile(
    val username: String,
    val email: String,
    val nusnetId: String,
    val facultyId: String
)
```

### äº¤é€šåå¥½
```kotlin
data class TransportPreferences(
    val prefersBus: Boolean,
    val prefersWalking: Boolean,
    val prefersCycling: Boolean,
    val prefersCarpool: Boolean
)
```

### å¸¸ç”¨åœ°ç‚¹
```kotlin
data class CommonLocations(
    val dormitory: String?,
    val teachingBuilding: String?,
    val studySpot: String?,
    val otherSpots: List<String>  // gym, canteen, lab, sports
)
```

### å…´è¶£ä¸ç›®æ ‡
```kotlin
data class InterestsAndGoals(
    val interests: List<String>,  // sustainability, challenges, community, rewards, leaderboard
    val weeklyGoal: Int,  // 1-20 trips
    val notifyChallenges: Boolean,
    val notifyReminders: Boolean,
    val notifyFriends: Boolean
)
```

### å®Œæ•´æ³¨å†Œæ•°æ®
```kotlin
data class CompleteRegistration(
    val profile: UserProfile,
    val faculty: FacultyData,
    val transport: TransportPreferences,
    val locations: CommonLocations,
    val interests: InterestsAndGoals,
    val isFirstLogin: Boolean = true
)
```

---

## ğŸ”§ SignupWizardFragment å®ç°è¦ç‚¹

### æ•°æ®å­—æ®µ
```kotlin
class SignupWizardFragment : Fragment() {
    private var currentStep = 0
    
    // Step 0: Personal Info
    private var username: String = ""
    private var email: String = ""
    private var nusnetId: String = ""
    
    // Step 1: Faculty
    private var selectedFaculty: FacultyData? = null
    
    // Step 2: Transport
    private val transportPrefs = mutableSetOf<String>()
    
    // Step 3: Locations
    private var dormitory: String? = null
    private var teachingBuilding: String? = null
    private var studySpot: String? = null
    private val otherLocations = mutableSetOf<String>()
    
    // Step 4: Interests & Goals
    private val interests = mutableSetOf<String>()
    private var weeklyGoal: Int = 5
    private var notifyChallenges: Boolean = true
    private var notifyReminders: Boolean = true
    private var notifyFriends: Boolean = false
}
```

### æ­¥éª¤æµç¨‹
```kotlin
fun showPersonalInfo() { currentStep = 0 }
fun showFacultySelection() { currentStep = 1 }
fun showTransportPreference() { currentStep = 2 }  // æ–°å¢
fun showCommonLocations() { currentStep = 3 }      // æ–°å¢
fun showInterestsGoals() { currentStep = 4 }       // æ–°å¢
fun showMascotReveal() { currentStep = 5 }
```

### æ–°å¢æ–¹æ³•æ¡†æ¶
```kotlin
private fun showTransportPreference() {
    // æ˜¾ç¤ºäº¤é€šåå¥½ç•Œé¢
    binding.layoutTransportPreference.visibility = View.VISIBLE
    
    // è®¾ç½®å¡ç‰‡ç‚¹å‡»ç›‘å¬
    setupTransportCards()
    
    // ContinueæŒ‰é’®
    binding.btnContinueTransport.setOnClickListener {
        showCommonLocations()
    }
}

private fun showCommonLocations() {
    // æ˜¾ç¤ºå¸¸ç”¨åœ°ç‚¹ç•Œé¢
    binding.layoutCommonLocations.visibility = View.VISIBLE
    
    // æ”¶é›†è¾“å…¥
    collectLocationInputs()
    
    // Skip & ContinueæŒ‰é’®
    binding.btnSkipLocations.setOnClickListener {
        showInterestsGoals()
    }
    binding.btnContinueLocations.setOnClickListener {
        showInterestsGoals()
    }
}

private fun showInterestsGoals() {
    // æ˜¾ç¤ºå…´è¶£ç›®æ ‡ç•Œé¢
    binding.layoutInterestsGoals.visibility = View.VISIBLE
    
    // è®¾ç½®ChipGroupã€Sliderã€Switchç›‘å¬
    setupInterestsAndGoals()
    
    // FinishæŒ‰é’®
    binding.btnFinishSignup.setOnClickListener {
        selectedFaculty?.let { showMascotReveal(it) }
    }
}
```

---

## ğŸ“ é¦–æ¬¡ç™»å½•æ£€æµ‹é€»è¾‘

### ä½¿ç”¨SharedPreferences
```kotlin
// ä¿å­˜é¦–æ¬¡ç™»å½•æ ‡è®°
fun saveFirstLoginStatus(context: Context, isFirstLogin: Boolean) {
    val prefs = context.getSharedPreferences("EcoGoPrefs", Context.MODE_PRIVATE)
    prefs.edit().putBoolean("is_first_login", isFirstLogin).apply()
}

// æ£€æŸ¥æ˜¯å¦é¦–æ¬¡ç™»å½•
fun isFirstLogin(context: Context): Boolean {
    val prefs = context.getSharedPreferences("EcoGoPrefs", Context.MODE_PRIVATE)
    return prefs.getBoolean("is_first_login", true)
}
```

### åœ¨MainActivityä¸­ä½¿ç”¨
```kotlin
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    
    // æ£€æŸ¥æ˜¯å¦é¦–æ¬¡ç™»å½•
    if (isFirstLogin(this) && isUserLoggedIn()) {
        // æ˜¾ç¤ºåŠŸèƒ½å¼•å¯¼
        navController.navigate(R.id.onboardingFragment)
        // æ ‡è®°ä¸ºå·²æ˜¾ç¤º
        saveFirstLoginStatus(this, false)
    }
}
```

---

## ğŸ“ OnboardingFragment å¢å¼º

### æ›´æ–°å†…å®¹æ•°æ®
```kotlin
// åœ¨OnboardingAdapterä¸­
data class OnboardingPage(
    val imageRes: Int,
    val emoji: String,
    val title: String,
    val description: String
)

val pages = listOf(
    OnboardingPage(
        emoji = "ğŸ‰",
        title = "Welcome to EcoGo!",
        description = "Transform your daily commute into environmental impact"
    ),
    OnboardingPage(
        emoji = "ğŸšŒ",
        title = "Track Your Green Trips",
        description = "Earn points for every eco-friendly journey"
    ),
    OnboardingPage(
        emoji = "ğŸ†",
        title = "Join Challenges",
        description = "Compete with friends and faculty for rewards"
    ),
    OnboardingPage(
        emoji = "ğŸ¨",
        title = "Customize Your Mascot",
        description = "Unlock outfits as you progress"
    ),
    OnboardingPage(
        emoji = "ğŸŒ±",
        title = "Ready to Start?",
        description = "Begin your first green trip today!"
    )
)
```

---

## ğŸ¯ ä¸ªæ€§åŒ–æ¨èåº”ç”¨

### 1. è·¯çº¿æ¨è
```kotlin
// æ ¹æ®äº¤é€šåå¥½æ¨èè·¯çº¿
if (user.prefersBus) {
    // ä¼˜å…ˆæ¨èå·´å£«è·¯çº¿
}
if (user.prefersWalking) {
    // æ¨èæ­¥è¡Œè·¯çº¿
}
```

### 2. æ´»åŠ¨æ¨è
```kotlin
// æ ¹æ®å…´è¶£æ¨èæ´»åŠ¨
if ("challenges" in user.interests) {
    // æ¨èæŒ‘æˆ˜æ´»åŠ¨
}
if ("community" in user.interests) {
    // æ¨èç¤¾åŒºæ´»åŠ¨
}
```

### 3. åœ°ç‚¹å¿«æ·è®¿é—®
```kotlin
// é¦–é¡µæ˜¾ç¤ºå¸¸ç”¨åœ°ç‚¹å¿«æ·å…¥å£
user.commonLocations.forEach { location ->
    addQuickAccessButton(location)
}
```

### 4. ç›®æ ‡è¿½è¸ª
```kotlin
// æ˜¾ç¤ºæ¯å‘¨ç›®æ ‡è¿›åº¦
val progress = user.completedTrips / user.weeklyGoal
showGoalProgress(progress)
```

### 5. æ™ºèƒ½é€šçŸ¥
```kotlin
// æ ¹æ®é€šçŸ¥åå¥½å‘é€é€šçŸ¥
if (user.notifyChallenges && newChallengeAvailable()) {
    sendNotification("New challenge available!")
}
```

---

## ğŸ” æ•°æ®æŒä¹…åŒ–

### æœ¬åœ°å­˜å‚¨ï¼ˆSharedPreferencesï¼‰
```kotlin
// ä¿å­˜æ³¨å†Œæ•°æ®
fun saveRegistrationData(context: Context, data: CompleteRegistration) {
    val prefs = context.getSharedPreferences("EcoGoPrefs", Context.MODE_PRIVATE)
    val json = Gson().toJson(data)
    prefs.edit().putString("registration_data", json).apply()
}
```

### åç«¯APIï¼ˆå»ºè®®ï¼‰
```kotlin
// POST /api/users/register
data class RegisterRequest(
    val username: String,
    val email: String,
    val nusnetId: String,
    val facultyId: String,
    val transportPreferences: List<String>,
    val commonLocations: Map<String, String>,
    val interests: List<String>,
    val weeklyGoal: Int,
    val notificationSettings: Map<String, Boolean>
)
```

---

## âœ… å®ç°æ¸…å•

### å·²å®Œæˆ
- âœ… Step 0: ä¸ªäººä¿¡æ¯ç•Œé¢
- âœ… Step 1: å­¦é™¢é€‰æ‹©ï¼ˆæ»‘åŠ¨å¡ç‰‡ï¼‰
- âœ… Step 2: äº¤é€šåå¥½å¸ƒå±€
- âœ… Step 3: å¸¸ç”¨åœ°ç‚¹å¸ƒå±€
- âœ… Step 4: å…´è¶£ç›®æ ‡å¸ƒå±€
- âœ… Step 5: å°ç‹®å­å±•ç¤º

### å¾…é›†æˆ
- â³ æ›´æ–°SignupWizardFragmentæ·»åŠ æ–°æ­¥éª¤é€»è¾‘
- â³ å®ç°æ•°æ®æ”¶é›†å’ŒéªŒè¯
- â³ æ›´æ–°OnboardingFragmentå†…å®¹ä¸ºåŠŸèƒ½å¼•å¯¼
- â³ å®ç°é¦–æ¬¡ç™»å½•æ£€æµ‹
- â³ åç«¯APIé›†æˆ
- â³ æ•°æ®æŒä¹…åŒ–

---

## ğŸš€ å¿«é€Ÿé›†æˆæŒ‡å—

### 1. æ·»åŠ bindingå¼•ç”¨
åœ¨SignupWizardFragmentä¸­æ·»åŠ æ–°å¸ƒå±€çš„bindingè®¿é—®ï¼š
```kotlin
// ç”±äºä½¿ç”¨äº†<include>ï¼Œbindingä¼šè‡ªåŠ¨åŒ…å«è¿™äº›å¸ƒå±€
binding.layoutTransportPreference
binding.layoutCommonLocations
binding.layoutInterestsGoals
```

### 2. å®ç°æ–°æ­¥éª¤æ–¹æ³•
å‚è€ƒä¸Šé¢çš„"æ–°å¢æ–¹æ³•æ¡†æ¶"å®ç°ä¸‰ä¸ªæ–°æ–¹æ³•

### 3. æ›´æ–°showFacultySelection()
```kotlin
// åœ¨é€‰æ‹©å­¦é™¢åè·³è½¬åˆ°äº¤é€šåå¥½
selectedFaculty = faculty
postDelayed({ showTransportPreference() }, 300)
```

### 4. æ›´æ–°completeSignup()
```kotlin
private fun completeSignup(faculty: FacultyData) {
    val registrationData = CompleteRegistration(
        profile = UserProfile(username, email, nusnetId, faculty.id),
        faculty = faculty,
        transport = TransportPreferences(/* ... */),
        locations = CommonLocations(/* ... */),
        interests = InterestsAndGoals(/* ... */)
    )
    
    // ä¿å­˜æ•°æ®
    saveRegistrationData(requireContext(), registrationData)
    
    // æ ‡è®°ä¸ºé¦–æ¬¡ç™»å½•
    saveFirstLoginStatus(requireContext(), true)
    
    // å¯¼èˆªåˆ°é¦–é¡µï¼ˆä¼šè‡ªåŠ¨è§¦å‘Onboardingï¼‰
    findNavController().navigate(R.id.action_signup_to_home)
}
```

---

*æ–‡æ¡£ç‰ˆæœ¬: 3.0*  
*ç”Ÿæˆæ—¶é—´: 2026-02-03*
